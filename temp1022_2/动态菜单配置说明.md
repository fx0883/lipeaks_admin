# Feedback System 动态菜单配置说明

## 📋 概述

本文档说明如何在后端系统中配置 Feedback System 的动态路由和菜单。

**配置位置**: 后端菜单管理系统  
**返回格式**: JSON  
**前端路由模式**: 动态路由

---

## 🎯 完整菜单配置 JSON

### 方案一：完整三级菜单结构（推荐）

```json
{
  "path": "/feedback",
  "name": "Feedback",
  "meta": {
    "title": "feedback.feedbackManagement",
    "rank": 10,
    "showLink": true,
    "icon": "ri:feedback-line",
    "showParent": true,
    "keepAlive": false,
    "frameLoading": false,
    "hiddenTag": false
  },
  "redirect": "/feedback/dashboard",
  "children": [
    {
      "path": "/feedback/dashboard",
      "name": "FeedbackDashboard",
      "meta": {
        "title": "feedback.dashboard",
        "rank": 0,
        "showLink": true,
        "icon": "ep:data-analysis",
        "showParent": true,
        "keepAlive": false,
        "frameLoading": false,
        "hiddenTag": false
      },
      "component": "/src/views/feedback/dashboard/index.vue"
    },
    {
      "path": "/feedback/software",
      "name": "FeedbackSoftware",
      "meta": {
        "title": "feedback.softwareManagement",
        "rank": 1,
        "showLink": true,
        "icon": "ep:folder-opened",
        "showParent": true,
        "keepAlive": false,
        "frameLoading": false,
        "hiddenTag": false
      },
      "children": [
        {
          "path": "/feedback/software/categories",
          "name": "SoftwareCategories",
          "meta": {
            "title": "feedback.software.categories",
            "rank": 0,
            "showLink": true,
            "icon": "ep:folder",
            "showParent": true,
            "keepAlive": false,
            "frameLoading": false,
            "hiddenTag": false
          },
          "component": "/src/views/feedback/software/categories/index.vue"
        },
        {
          "path": "/feedback/software/products",
          "name": "SoftwareProducts",
          "meta": {
            "title": "feedback.software.products",
            "rank": 1,
            "showLink": true,
            "icon": "ep:box",
            "showParent": true,
            "keepAlive": false,
            "frameLoading": false,
            "hiddenTag": false
          },
          "component": "/src/views/feedback/software/products/index.vue"
        },
        {
          "path": "/feedback/software/products/create",
          "name": "SoftwareProductCreate",
          "meta": {
            "title": "feedback.software.productCreate",
            "rank": 0,
            "showLink": false,
            "showParent": false,
            "keepAlive": false,
            "frameLoading": false,
            "hiddenTag": false
          },
          "component": "/src/views/feedback/software/products/create.vue"
        },
        {
          "path": "/feedback/software/products/detail/:id",
          "name": "SoftwareProductDetail",
          "meta": {
            "title": "feedback.software.productDetail",
            "rank": 0,
            "showLink": false,
            "showParent": false,
            "keepAlive": false,
            "frameLoading": false,
            "hiddenTag": false
          },
          "component": "/src/views/feedback/software/products/detail.vue"
        },
        {
          "path": "/feedback/software/versions",
          "name": "SoftwareVersions",
          "meta": {
            "title": "feedback.software.versions",
            "rank": 2,
            "showLink": true,
            "icon": "ep:list",
            "showParent": true,
            "keepAlive": false,
            "frameLoading": false,
            "hiddenTag": false
          },
          "component": "/src/views/feedback/software/versions/index.vue"
        }
      ]
    },
    {
      "path": "/feedback/feedbacks",
      "name": "FeedbackManagement",
      "meta": {
        "title": "feedback.feedbacks.list",
        "rank": 2,
        "showLink": true,
        "icon": "ri:message-2-line",
        "showParent": true,
        "keepAlive": true,
        "frameLoading": false,
        "hiddenTag": false
      },
      "children": [
        {
          "path": "/feedback/feedbacks/list",
          "name": "FeedbackList",
          "meta": {
            "title": "feedback.feedbacks.list",
            "rank": 0,
            "showLink": true,
            "icon": "ri:file-list-line",
            "showParent": false,
            "keepAlive": true,
            "frameLoading": false,
            "hiddenTag": false
          },
          "component": "/src/views/feedback/feedbacks/index.vue"
        },
        {
          "path": "/feedback/feedbacks/submit",
          "name": "FeedbackSubmit",
          "meta": {
            "title": "feedback.feedbacks.submit",
            "rank": 1,
            "showLink": true,
            "icon": "ep:edit",
            "showParent": false,
            "keepAlive": false,
            "frameLoading": false,
            "hiddenTag": false
          },
          "component": "/src/views/feedback/feedbacks/submit.vue"
        },
        {
          "path": "/feedback/feedbacks/detail/:id",
          "name": "FeedbackDetail",
          "meta": {
            "title": "feedback.feedbacks.detail",
            "rank": 0,
            "showLink": false,
            "showParent": false,
            "keepAlive": false,
            "frameLoading": false,
            "hiddenTag": false
          },
          "component": "/src/views/feedback/feedbacks/detail.vue"
        }
      ]
    },
    {
      "path": "/feedback/email",
      "name": "FeedbackEmail",
      "meta": {
        "title": "feedback.emailManagement",
        "rank": 3,
        "showLink": true,
        "icon": "ep:message",
        "showParent": true,
        "keepAlive": false,
        "frameLoading": false,
        "hiddenTag": false
      },
      "children": [
        {
          "path": "/feedback/email/templates",
          "name": "EmailTemplates",
          "meta": {
            "title": "feedback.email.templates",
            "rank": 0,
            "showLink": true,
            "icon": "ep:document",
            "showParent": true,
            "keepAlive": false,
            "frameLoading": false,
            "hiddenTag": false
          },
          "component": "/src/views/feedback/email/templates/index.vue"
        },
        {
          "path": "/feedback/email/logs",
          "name": "EmailLogs",
          "meta": {
            "title": "feedback.email.logs",
            "rank": 1,
            "showLink": true,
            "icon": "ep:document-checked",
            "showParent": true,
            "keepAlive": false,
            "frameLoading": false,
            "hiddenTag": false
          },
          "component": "/src/views/feedback/email/logs/index.vue"
        }
      ]
    },
    {
      "path": "/feedback/statistics",
      "name": "FeedbackStatistics",
      "meta": {
        "title": "feedback.statistics",
        "rank": 4,
        "showLink": true,
        "icon": "ep:data-line",
        "showParent": true,
        "keepAlive": false,
        "frameLoading": false,
        "hiddenTag": false
      },
      "component": "/src/views/feedback/statistics/index.vue"
    },
    {
      "path": "/feedback/health",
      "name": "FeedbackHealth",
      "meta": {
        "title": "feedback.systemHealth",
        "rank": 5,
        "showLink": true,
        "icon": "ep:monitor",
        "showParent": true,
        "keepAlive": false,
        "frameLoading": false,
        "hiddenTag": false
      },
      "component": "/src/views/feedback/health/index.vue"
    }
  ]
}
```

---

## 🎨 菜单层级说明

### 一级菜单：反馈管理
- **路径**: `/feedback`
- **图标**: `ri:feedback-line`
- **排序**: `rank: 10`

### 二级菜单

1. **反馈仪表板** (`/feedback/dashboard`)
   - 显示关键统计数据
   - 图表展示
   - 快速概览

2. **软件管理** (`/feedback/software`)
   - 三级菜单：软件分类
   - 三级菜单：软件产品
   - 三级菜单：软件版本

3. **反馈管理** (`/feedback/feedbacks`)
   - 三级菜单：反馈列表
   - 三级菜单：提交反馈
   - 隐藏路由：反馈详情

4. **邮件管理** (`/feedback/email`)
   - 三级菜单：邮件模板
   - 三级菜单：邮件日志

5. **统计分析** (`/feedback/statistics`)
   - 独立页面

6. **系统健康** (`/feedback/health`)
   - 独立页面

---

## 🔑 Meta 配置说明

### 必填字段

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| `title` | string | 菜单标题（国际化key） | `feedback.dashboard` |
| `rank` | number | 排序值（越小越靠前） | `0`, `1`, `2` |
| `showLink` | boolean | 是否在菜单中显示 | `true` / `false` |
| `icon` | string | 图标名称 | `ep:data-analysis` |
| `showParent` | boolean | 是否显示父级路径 | `true` / `false` |
| `keepAlive` | boolean | 是否缓存页面 | `true` / `false` |

### 可选字段

| 字段 | 说明 | 默认值 |
|------|------|--------|
| `frameLoading` | 是否显示加载动画 | `false` |
| `hiddenTag` | 是否隐藏标签页 | `false` |
| `roles` | 角色权限控制 | 无 |

---

## 👥 权限配置建议

### 根据角色显示菜单

**超级管理员/租户管理员（显示全部）：**
```json
"meta": {
  "roles": ["admin", "super_admin"]
}
```

**仅管理员可见的菜单：**
- 软件管理
- 邮件管理
- 统计分析
- 系统健康

**所有用户可见的菜单：**
- 反馈列表
- 提交反馈

### 权限配置示例

```json
{
  "path": "/feedback/software",
  "meta": {
    "title": "feedback.softwareManagement",
    "roles": ["admin", "super_admin"],
    "showLink": true
  }
}
```

---

## 📱 菜单显示效果

### 在侧边栏的显示层级

```
反馈管理 (Feedback)
├── 反馈仪表板 (Dashboard)
├── 软件管理 (Software)
│   ├── 软件分类 (Categories)
│   ├── 软件产品 (Products)
│   └── 软件版本 (Versions)
├── 反馈管理 (Feedbacks)
│   ├── 反馈列表 (List)
│   └── 提交反馈 (Submit)
├── 邮件管理 (Email)
│   ├── 邮件模板 (Templates)
│   └── 邮件日志 (Logs)
├── 统计分析 (Statistics)
└── 系统健康 (Health)
```

---

## 🔧 方案二：简化二级菜单结构

如果不需要三级菜单，可以使用扁平化结构：

```json
{
  "path": "/feedback",
  "name": "Feedback",
  "meta": {
    "title": "feedback.feedbackManagement",
    "rank": 10,
    "showLink": true,
    "icon": "ri:feedback-line",
    "showParent": true
  },
  "redirect": "/feedback/dashboard",
  "children": [
    {
      "path": "/feedback/dashboard",
      "name": "FeedbackDashboard",
      "meta": {
        "title": "feedback.dashboard",
        "rank": 0,
        "showLink": true,
        "icon": "ep:data-analysis"
      },
      "component": "/src/views/feedback/dashboard/index.vue"
    },
    {
      "path": "/feedback/software/categories",
      "name": "SoftwareCategories",
      "meta": {
        "title": "feedback.software.categories",
        "rank": 1,
        "showLink": true,
        "icon": "ep:folder"
      },
      "component": "/src/views/feedback/software/categories/index.vue"
    },
    {
      "path": "/feedback/software/products",
      "name": "SoftwareProducts",
      "meta": {
        "title": "feedback.software.products",
        "rank": 2,
        "showLink": true,
        "icon": "ep:box"
      },
      "component": "/src/views/feedback/software/products/index.vue"
    },
    {
      "path": "/feedback/feedbacks/list",
      "name": "FeedbackList",
      "meta": {
        "title": "feedback.feedbacks.list",
        "rank": 3,
        "showLink": true,
        "icon": "ri:file-list-line"
      },
      "component": "/src/views/feedback/feedbacks/index.vue"
    },
    {
      "path": "/feedback/feedbacks/submit",
      "name": "FeedbackSubmit",
      "meta": {
        "title": "feedback.feedbacks.submit",
        "rank": 4,
        "showLink": true,
        "icon": "ep:edit"
      },
      "component": "/src/views/feedback/feedbacks/submit.vue"
    },
    {
      "path": "/feedback/email/templates",
      "name": "EmailTemplates",
      "meta": {
        "title": "feedback.email.templates",
        "rank": 5,
        "showLink": true,
        "icon": "ep:document",
        "roles": ["admin", "super_admin"]
      },
      "component": "/src/views/feedback/email/templates/index.vue"
    },
    {
      "path": "/feedback/statistics",
      "name": "FeedbackStatistics",
      "meta": {
        "title": "feedback.statistics",
        "rank": 6,
        "showLink": true,
        "icon": "ep:data-line",
        "roles": ["admin", "super_admin"]
      },
      "component": "/src/views/feedback/statistics/index.vue"
    }
  ]
}
```

---

## 📝 隐藏路由配置

以下路由需要配置但不在菜单中显示（`showLink: false`）：

```json
[
  {
    "path": "/feedback/feedbacks/detail/:id",
    "name": "FeedbackDetail",
    "meta": {
      "title": "feedback.feedbacks.detail",
      "showLink": false,
      "showParent": false
    },
    "component": "/src/views/feedback/feedbacks/detail.vue"
  },
  {
    "path": "/feedback/software/products/create",
    "name": "SoftwareProductCreate",
    "meta": {
      "title": "feedback.software.productCreate",
      "showLink": false,
      "showParent": false
    },
    "component": "/src/views/feedback/software/products/create.vue"
  },
  {
    "path": "/feedback/software/products/detail/:id",
    "name": "SoftwareProductDetail",
    "meta": {
      "title": "feedback.software.productDetail",
      "showLink": false,
      "showParent": false
    },
    "component": "/src/views/feedback/software/products/detail.vue"
  }
]
```

---

## 🎯 图标参考

### 推荐图标

| 功能 | 图标 | 样式 |
|------|------|------|
| 反馈管理 | `ri:feedback-line` | 线性 |
| 仪表板 | `ep:data-analysis` | Element Plus |
| 软件管理 | `ep:folder-opened` | Element Plus |
| 软件分类 | `ep:folder` | Element Plus |
| 软件产品 | `ep:box` | Element Plus |
| 版本管理 | `ep:list` | Element Plus |
| 反馈列表 | `ri:file-list-line` | Remix Icon |
| 提交反馈 | `ep:edit` | Element Plus |
| 邮件模板 | `ep:document` | Element Plus |
| 邮件日志 | `ep:document-checked` | Element Plus |
| 统计分析 | `ep:data-line` | Element Plus |
| 系统健康 | `ep:monitor` | Element Plus |

---

## ⚙️ 后端配置步骤

### 1. 在菜单管理中添加一级菜单

```
名称：反馈管理
路径：/feedback
图标：ri:feedback-line
排序：10
状态：启用
```

### 2. 添加二级菜单

按照上面的 JSON 结构，在后端菜单管理系统中逐个添加。

### 3. 设置权限

- **反馈仪表板**: 所有用户
- **软件管理**: 仅管理员
- **反馈列表**: 所有用户
- **提交反馈**: 所有用户
- **邮件管理**: 仅管理员
- **统计分析**: 仅管理员
- **系统健康**: 仅管理员

### 4. 国际化配置

确保国际化文件中已添加所有翻译键：

**中文 (zh-CN.yaml)**:
```yaml
feedback:
  feedbackManagement: 反馈管理
  dashboard: 反馈仪表板
  software:
    categories: 软件分类
    products: 软件产品
    versions: 软件版本
  # ... 其他翻译
```

**英文 (en.yaml)**:
```yaml
feedback:
  feedbackManagement: Feedback Management
  dashboard: Feedback Dashboard
  software:
    categories: Software Categories
    products: Software Products
    versions: Software Versions
  # ... 其他翻译
```

---

## 📦 完整路由列表

### 需要在后端配置的所有路由

| 序号 | 路径 | 名称 | 显示 | 权限 | 组件 |
|------|------|------|------|------|------|
| 1 | `/feedback/dashboard` | FeedbackDashboard | ✅ | 所有 | dashboard/index.vue |
| 2 | `/feedback/software/categories` | SoftwareCategories | ✅ | 管理员 | software/categories/index.vue |
| 3 | `/feedback/software/products` | SoftwareProducts | ✅ | 管理员 | software/products/index.vue |
| 4 | `/feedback/software/products/create` | SoftwareProductCreate | ❌ | 管理员 | software/products/create.vue |
| 5 | `/feedback/software/products/detail/:id` | SoftwareProductDetail | ❌ | 管理员 | software/products/detail.vue |
| 6 | `/feedback/software/versions` | SoftwareVersions | ✅ | 管理员 | software/versions/index.vue |
| 7 | `/feedback/feedbacks/list` | FeedbackList | ✅ | 所有 | feedbacks/index.vue |
| 8 | `/feedback/feedbacks/submit` | FeedbackSubmit | ✅ | 所有 | feedbacks/submit.vue |
| 9 | `/feedback/feedbacks/detail/:id` | FeedbackDetail | ❌ | 所有 | feedbacks/detail.vue |
| 10 | `/feedback/email/templates` | EmailTemplates | ✅ | 管理员 | email/templates/index.vue |
| 11 | `/feedback/email/logs` | EmailLogs | ✅ | 管理员 | email/logs/index.vue |
| 12 | `/feedback/statistics` | FeedbackStatistics | ✅ | 管理员 | statistics/index.vue |
| 13 | `/feedback/health` | FeedbackHealth | ✅ | 管理员 | health/index.vue |

**总计**: 13 个路由

---

## 🚀 快速配置指南

### 步骤1：导入 JSON

将上面的完整 JSON 配置复制到后端菜单管理系统。

### 步骤2：调整排序

根据需要调整 `rank` 值：
- 数值越小，菜单位置越靠前
- 建议设置为 10，在其他模块之后

### 步骤3：设置权限

为需要权限控制的菜单添加 `roles` 配置。

### 步骤4：测试

1. 登录系统
2. 检查菜单是否正确显示
3. 点击菜单项验证页面跳转
4. 检查权限控制是否生效

---

## 💡 注意事项

### 1. 组件路径格式

**正确格式**:
```json
"component": "/src/views/feedback/dashboard/index.vue"
```

**注意**:
- 必须以 `/src/` 开头
- 路径必须与实际文件路径一致
- 扩展名 `.vue` 必须包含

### 2. 动态路由参数

带参数的路由使用 `:id` 格式：
```json
"path": "/feedback/feedbacks/detail/:id"
```

### 3. 国际化 Key

所有 `title` 字段必须使用国际化 key，不要直接写中文：

**正确**:
```json
"title": "feedback.dashboard"
```

**错误**:
```json
"title": "反馈仪表板"  // ❌
```

### 4. Redirect 配置

顶级路由需要设置 redirect：
```json
{
  "path": "/feedback",
  "redirect": "/feedback/dashboard"
}
```

---

## 🎯 最小化配置（仅核心功能）

如果只需要基本功能，可以只配置：

```json
{
  "path": "/feedback",
  "name": "Feedback",
  "meta": {
    "title": "feedback.feedbackManagement",
    "icon": "ri:feedback-line",
    "showLink": true
  },
  "redirect": "/feedback/feedbacks/list",
  "children": [
    {
      "path": "/feedback/feedbacks/list",
      "name": "FeedbackList",
      "meta": {
        "title": "feedback.feedbacks.list",
        "showLink": true,
        "icon": "ri:file-list-line"
      },
      "component": "/src/views/feedback/feedbacks/index.vue"
    },
    {
      "path": "/feedback/feedbacks/submit",
      "name": "FeedbackSubmit",
      "meta": {
        "title": "feedback.feedbacks.submit",
        "showLink": true,
        "icon": "ep:edit"
      },
      "component": "/src/views/feedback/feedbacks/submit.vue"
    },
    {
      "path": "/feedback/feedbacks/detail/:id",
      "name": "FeedbackDetail",
      "meta": {
        "title": "feedback.feedbacks.detail",
        "showLink": false
      },
      "component": "/src/views/feedback/feedbacks/detail.vue"
    }
  ]
}
```

这样只显示：
- 反馈列表
- 提交反馈

管理功能可以后续添加。

---

## 📞 技术支持

### 配置问题排查

**问题1: 菜单不显示**
- 检查 `showLink` 是否为 `true`
- 检查用户是否有权限（roles 配置）
- 检查 `rank` 值是否正确

**问题2: 页面404**
- 检查 `component` 路径是否正确
- 检查文件是否存在
- 检查路径是否以 `/src/` 开头

**问题3: 国际化不生效**
- 检查 `title` 是否使用 i18n key
- 检查 locales 文件中是否有对应翻译
- 检查 i18n key 拼写是否正确

---

## ✅ 配置检查清单

### 配置前
- [ ] 确认后端支持动态路由
- [ ] 确认菜单管理系统可用
- [ ] 确认权限控制机制

### 配置中
- [ ] 复制完整 JSON 配置
- [ ] 调整 rank 排序值
- [ ] 设置权限（roles）
- [ ] 检查路径格式

### 配置后
- [ ] 登录系统验证菜单显示
- [ ] 点击菜单验证页面跳转
- [ ] 测试权限控制
- [ ] 测试隐藏路由（详情页等）
- [ ] 测试国际化切换

---

## 📊 配置效果预览

### 管理员视图
```
侧边栏：
├── 仪表板
├── 客户管理
├── 订单管理
├── 许可证管理
├── CMS
└── 反馈管理 ⭐ 新增
    ├── 反馈仪表板
    ├── 软件管理
    │   ├── 软件分类
    │   ├── 软件产品
    │   └── 软件版本
    ├── 反馈管理
    │   ├── 反馈列表
    │   └── 提交反馈
    ├── 邮件管理
    │   ├── 邮件模板
    │   └── 邮件日志
    ├── 统计分析
    └── 系统健康
```

### 普通用户视图
```
侧边栏：
├── 仪表板
└── 反馈管理 ⭐ 新增
    ├── 反馈仪表板
    ├── 反馈列表
    └── 提交反馈
```

---

## 🎉 完成

现在您可以：
1. 将完整 JSON 配置导入后端
2. 根据需要调整菜单结构
3. 设置合适的权限
4. 测试菜单显示和功能

**祝配置顺利！** 🚀

