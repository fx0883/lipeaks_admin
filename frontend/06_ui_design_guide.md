# 用户界面设计指南

## 概述

本文档提供错误处理相关的UI设计指南，帮助前端团队设计用户友好的错误界面。

## 错误提示UI设计

### 提示组件类型

| 组件类型 | 使用场景 | 特点 | 示例 |
|---------|---------|------|------|
| **Toast/Snackbar** | 轻量提示 | 自动消失、不阻塞 | "保存成功"、"删除失败" |
| **Message** | 重要提示 | 可手动关闭 | "配额已满"、"权限不足" |
| **Modal/Dialog** | 需要确认 | 模态对话框、必须操作 | "账户已禁用"、"许可证过期" |
| **Alert/Banner** | 页面级提示 | 持续显示、突出 | "您的试用期还剩3天" |
| **Inline Error** | 字段错误 | 显示在字段下 | "该字段不能为空" |
| **Error Page** | 严重错误 | 全屏显示 | 404页面、500页面 |

### Toast提示设计

**位置：**
```
推荐位置:
  - 顶部中央：适合全局提示
  - 顶部右侧：适合多个提示堆叠
  - 底部中央：适合移动端

避免:
  - 左右侧边：容易被忽略
  - 底部角落：与浮动按钮冲突
```

**样式：**
```
Toast样式设计:

成功Toast:
  图标: ✅ 或 绿色对勾
  背景色: 浅绿色 (#E8F5E9)
  文字色: 深绿色 (#2E7D32)

错误Toast:
  图标: ❌ 或 红色叉号
  背景色: 浅红色 (#FFEBEE)
  文字色: 深红色 (#C62828)

警告Toast:
  图标: ⚠️ 或 黄色感叹号
  背景色: 浅黄色 (#FFF3E0)
  文字色: 深橙色 (#E65100)

信息Toast:
  图标: ℹ️ 或 蓝色信息图标
  背景色: 浅蓝色 (#E3F2FD)
  文字色: 深蓝色 (#1565C0)
```

**持续时间：**
```
Toast显示时长:
  - 成功提示: 2-3秒
  - 信息提示: 3秒
  - 警告提示: 4秒
  - 错误提示: 5秒
  - 重要错误: 不自动消失，需手动关闭
```

### Modal对话框设计

**Modal使用场景：**
```
使用Modal的情况:
  ✅ 需要用户明确知晓的错误
  ✅ 需要用户做出选择的错误
  ✅ 阻断性错误（如账户被禁用）
  ✅ 提供操作指引的错误

Modal结构:
  [图标] 标题
  
  错误消息内容
  （可以包含详细说明）
  
  [主要按钮] [次要按钮]
```

**Modal类型：**
```
1. 信息Modal (Info)
   用途: 提示性信息
   图标: ℹ️ 蓝色
   按钮: "我知道了" 或 自定义操作

2. 警告Modal (Warning)
   用途: 警告信息
   图标: ⚠️ 黄色
   按钮: "我知道了" 或 "取消"

3. 错误Modal (Error)
   用途: 错误信息
   图标: ❌ 红色
   按钮: "关闭" 或 "重试"

4. 确认Modal (Confirm)
   用途: 需要用户确认
   图标: ❓ 或 无
   按钮: "确认" + "取消"
```

### 字段错误设计

**显示位置：**
```
字段错误显示:

[标签] 字段名称
[输入框] ← 红色边框
❌ 错误消息（红色文字）
```

**视觉设计：**
```
错误状态:
  - 输入框边框: 红色（#F44336）
  - 错误图标: ❌ 红色
  - 错误文字: 红色，12-14px
  - 背景色: 可选淡红色

正常状态:
  - 输入框边框: 灰色（#BDBDBD）
  - 无错误图标
  - 无错误文字
```

**交互行为：**
```
错误显示时机:
  1. 失去焦点时（blur）
  2. 提交表单时
  3. API返回验证错误时

错误清除时机:
  1. 用户修改字段内容时
  2. 重新提交表单前
  3. 用户点击"清除"按钮
```

## Loading状态设计

### Loading类型

**1. 全屏Loading**
```
使用场景:
  - 页面首次加载
  - 登录中
  - 重要操作处理中

设计:
  [Loading图标/动画]
  加载中...
  （半透明遮罩覆盖整个页面）
```

**2. 局部Loading**
```
使用场景:
  - 列表刷新
  - 表格分页切换
  - 局部数据更新

设计:
  在数据区域显示Loading遮罩
  不影响页面其他部分
```

**3. 按钮Loading**
```
使用场景:
  - 表单提交
  - 操作按钮点击

设计:
  按钮内显示loading图标
  按钮文字: "提交中..." 或 "处理中..."
  按钮禁用，防止重复点击
```

**4. 骨架屏**
```
使用场景:
  - 列表首次加载
  - 卡片数据加载
  - 内容较多的页面

优点:
  - 让用户感知到内容结构
  - 比纯Loading体验更好
  - 避免页面跳动
```

### Loading时长处理

```
Loading策略:

短时间请求 (<500ms):
  不显示Loading
  直接显示结果
  避免Loading闪烁

中等时间请求 (500ms-3s):
  立即显示Loading
  完成后隐藏

长时间请求 (>3s):
  显示Loading
  + 进度提示
  + 预计剩余时间
  + "正在处理，请稍候..."
```

## 错误页面设计

### 404错误页

```
404页面设计:

[大号图标或插画]
🔍 或 404

标题: "页面不存在"

说明: "抱歉，您访问的页面不存在或已被删除"

操作按钮:
  [返回首页]  [返回上一页]
```

### 403权限错误页

```
403页面设计:

[大号图标]
🚫 或 403

标题: "权限不足"

说明: "您没有权限访问此页面"

操作按钮:
  [返回首页]  [申请权限]
```

### 500服务器错误页

```
500页面设计:

[大号图标]
🔥 或 500

标题: "服务器错误"

说明: "服务器遇到了一些问题，我们正在处理中"

操作按钮:
  [重试]  [返回首页]

额外信息（可选）:
  错误码: {code}
  时间: {timestamp}
  （便于用户联系客服时提供）
```

### 网络错误页

```
网络错误页设计:

[大号图标]
📡 或 WiFi断开图标

标题: "网络连接失败"

说明: "请检查您的网络连接"

操作按钮:
  [重试]

提示:
  "如果问题持续，请检查：
   - WiFi或移动网络是否连接
   - 是否开启了飞行模式
   - 防火墙设置是否正确"
```

## 空状态设计

### 无数据状态

```
空状态设计（不是错误，但需要设计）:

[插画图标]
📭 空箱子或相关图标

标题: "还没有数据"

说明: "您还没有创建任何租户"

操作按钮:
  [创建第一个租户]
```

### 搜索无结果

```
搜索无结果设计:

[搜索图标]
🔍

标题: "未找到匹配结果"

说明: "没有找到包含 "{keyword}" 的租户"

建议:
  - 检查关键词拼写
  - 尝试其他关键词
  - 清除筛选条件

操作:
  [清除搜索]
```

## 用户引导设计

### 操作建议

```
错误提示中提供操作建议:

许可证过期:
  ❌ "许可证已过期"
  ✅ "许可证已过期，立即续费可继续使用"
     [立即续费] 按钮

积分不足:
  ❌ "积分余额不足"
  ✅ "积分不足（还需400分），完成任务可获取积分"
     [去做任务] 按钮

权限不足:
  ❌ "权限不足"
  ✅ "您没有权限执行此操作，如有需要请联系管理员"
     [联系管理员] 按钮（打开客服对话或显示联系方式）
```

### 错误恢复路径

```
为用户提供明确的恢复路径:

认证错误:
  "登录已过期" → [重新登录] → 登录页 → 登录成功 → 返回原页面

配额超限:
  "配额已满" → [升级套餐] → 升级页面 → 选择套餐 → 支付 → 配额增加

资源不存在:
  "租户不存在" → [返回列表] → 租户列表 → 重新选择

积分不足:
  "积分不足" → [获取积分] → 任务中心 → 完成任务 → 获得积分 → 返回继续
```

## 响应式设计

### 移动端适配

```
移动端错误提示:

Toast位置:
  - 顶部或底部中央
  - 不要左右侧
  - 考虑安全区域（刘海屏）

Modal大小:
  - 占屏幕80-90%宽度
  - 不要太小（难以点击）
  - 按钮足够大（至少44px高）

字段错误:
  - 错误文字足够大（至少14px）
  - 充足的点击区域
  - 考虑横屏模式

错误页面:
  - 垂直布局
  - 图标适当缩小
  - 按钮堆叠而非并排
```

### 小程序适配

```
小程序错误提示:

使用小程序原生组件:
  - wx.showToast() - 轻提示
  - wx.showModal() - 对话框
  - wx.showLoading() - Loading

注意事项:
  - Toast最多显示7个汉字
  - Modal标题不要太长
  - 考虑不同机型的适配
```

## 可访问性（A11y）

### 屏幕阅读器支持

```
可访问性要点:

1. 错误提示添加ARIA属性
   role="alert"
   aria-live="polite"  // 或 "assertive"

2. 字段错误关联
   <label for="name">姓名</label>
   <input id="name" aria-describedby="name-error">
   <span id="name-error" role="alert">该字段不能为空</span>

3. Loading状态通知
   aria-busy="true"
   aria-label="正在加载..."

4. 键盘导航
   错误对话框可以用ESC键关闭
   Tab键可以在按钮间切换
```

## 动画和过渡

### 错误提示动画

```
动画设计:

Toast出现:
  - 淡入 + 向下滑动
  - 时长: 300ms
  - 缓动: ease-out

Toast消失:
  - 淡出 + 向上滑动
  - 时长: 200ms
  - 缓动: ease-in

Modal出现:
  - 背景遮罩淡入
  - 对话框缩放+淡入
  - 时长: 200ms

字段错误:
  - 红色边框过渡
  - 错误文字淡入
  - 轻微抖动（可选）
```

## 错误提示文案

### 文案原则

1. **简洁明了** - 一句话说清楚
2. **用户视角** - 避免技术术语
3. **提供帮助** - 告诉用户怎么做
4. **礼貌友好** - 不责怪用户

### 文案示例

**好的文案：**
```
✅ "密码长度至少8位"
✅ "该邮箱已被注册，请使用其他邮箱"
✅ "许可证已过期，续费后可继续使用"
✅ "网络连接失败，请检查您的网络设置"
✅ "您没有权限执行此操作，如有需要请联系管理员"
```

**不好的文案：**
```
❌ "Error"
❌ "Failed"
❌ "Invalid input"
❌ "Database connection error"
❌ "NullPointerException"
```

### 错误消息改写

| 原始消息（技术性） | 优化后（用户友好） |
|------------------|------------------|
| "Validation failed" | "请检查输入信息" |
| "Unauthorized" | "登录已过期，请重新登录" |
| "Forbidden" | "您没有权限执行此操作" |
| "Internal server error" | "服务器暂时不可用，请稍后重试" |
| "Database error" | "系统繁忙，请稍后重试" |

## 颜色系统

### 错误相关颜色

```
推荐色值:

成功色:
  主色: #4CAF50 (绿色)
  浅色: #E8F5E9
  深色: #2E7D32

错误色:
  主色: #F44336 (红色)
  浅色: #FFEBEE
  深色: #C62828

警告色:
  主色: #FF9800 (橙色)
  浅色: #FFF3E0
  深色: #E65100

信息色:
  主色: #2196F3 (蓝色)
  浅色: #E3F2FD
  深色: #1565C0
```

## 响应时间和反馈

### 即时反馈

```
操作后立即给予反馈:

用户点击按钮:
  0ms: 按钮状态变化（pressed状态）
  50ms: 显示Loading（如果需要）
  
请求发送:
  立即: 禁用按钮
  立即: 显示Loading状态
  
请求完成:
  立即: 显示成功/错误提示
  立即: 启用按钮
  立即: 隐藏Loading

原则:
  - 任何操作都要有即时视觉反馈
  - 不要让用户等待无反馈
  - Loading应该在100ms内显示
```

## 错误页面布局

### 标准错误页布局

```
错误页面结构:

┌─────────────────────────────┐
│                             │
│         [大号图标]           │  ← 顶部1/3
│                             │
├─────────────────────────────┤
│       [错误标题]             │  ← 中部1/3
│       错误说明文字            │
│       （可选的详细信息）       │
├─────────────────────────────┤
│    [主要按钮] [次要按钮]      │  ← 底部1/3
│                             │
└─────────────────────────────┘
```

### 示例布局（ASCII）

```
          🔍
          
     页面不存在
     
  您访问的页面不存在或已被删除
  
  ┌──────────┐  ┌──────────┐
  │ 返回首页  │  │ 返回上页  │
  └──────────┘  └──────────┘
```

## 多语言支持

### 国际化考虑

```
错误提示国际化:

方案1: 后端提供多语言
  - 根据Accept-Language请求头返回对应语言
  - 前端直接使用response.message

方案2: 前端维护翻译
  - 根据error_code从翻译表获取
  - 支持的语言: 中文、英文、日文等
  
翻译表结构:
  {
    'TENANT_NOT_FOUND': {
      'zh': '租户不存在',
      'en': 'Tenant not found',
      'ja': 'テナントが見つかりません'
    },
    'LICENSE_EXPIRED': {
      'zh': '许可证已过期',
      'en': 'License has expired',
      'ja': 'ライセンスが期限切れです'
    }
  }
```

## 最佳实践

### UI设计原则

1. **一致性** - 同类错误使用相同的提示方式
2. **可见性** - 错误提示足够明显，用户不会错过
3. **简洁性** - 不要用太多文字，一句话说清
4. **可操作性** - 告诉用户下一步怎么做
5. **非侵入性** - 轻微错误不要打断用户
6. **响应性** - 适配不同屏幕尺寸

### 避免的反模式

❌ **不要做的事：**
- 显示技术性错误消息（如堆栈信息）
- 使用模态对话框提示轻微错误
- 错误提示一闪而过，用户看不清
- 多个Toast同时出现重叠
- 错误页面没有返回路径
- 移动端按钮太小难以点击
- 无障碍支持缺失

## 总结

### UI设计核心

1. ✅ **分级提示** - 根据严重程度选择提示方式
2. ✅ **即时反馈** - 任何操作都有视觉反馈
3. ✅ **清晰指引** - 告诉用户下一步怎么做
4. ✅ **友好文案** - 用户能理解的语言
5. ✅ **响应式** - 适配各种设备和屏幕

### 设计清单

- [ ] Toast组件设计完成
- [ ] Modal组件设计完成
- [ ] 字段错误样式定义
- [ ] Loading状态设计
- [ ] 错误页面设计（404、403、500）
- [ ] 空状态设计
- [ ] 移动端适配
- [ ] 可访问性支持

---

**维护者**: Lipeaks Frontend Team  
**最后更新**: 2025-01-08

