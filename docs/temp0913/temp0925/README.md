# 多租户积分系统 API 文档

## 📋 文档目录

本文档详细介绍了多租户积分系统的API接口使用方法、参数说明、响应格式和实际使用案例。

### 📖 文档结构

| 文档文件 | 内容描述 |
|---------|---------|
| [README.md](./README.md) | 📚 总览和快速开始指南 |
| [01_API总览.md](./01_API总览.md) | 🏗️ API架构、认证和基础信息 |
| [02_积分系统API.md](./02_积分系统API.md) | 🎯 用户档案、积分操作相关API |
| [03_VIP标签管理API.md](./03_VIP标签管理API.md) | 💎 VIP标签管理和权限API |
| [04_许可证分配API.md](./04_许可证分配API.md) | 📄 许可证分配管理API |
| [05_统计分析API.md](./05_统计分析API.md) | 📊 积分统计和数据分析API |
| [06_用户场景和用例.md](./06_用户场景和用例.md) | 🎭 业务场景和实际使用案例 |
| [07_错误处理和最佳实践.md](./07_错误处理和最佳实践.md) | ⚠️ 错误处理、最佳实践指南 |

---

## 🚀 快速开始

### 环境要求

- **Django**: 5.2+
- **Python**: 3.8+
- **数据库**: MySQL 8.0+ / PostgreSQL 12+
- **认证**: JWT Bearer Token

### 基础配置

```bash
# 1. 启动开发服务器
python manage.py runserver

# 2. 访问API文档
http://localhost:8000/api/v1/docs/

# 3. 基础API路径
http://localhost:8000/api/v1/
```

### 认证方式

所有API都需要JWT Bearer Token认证：

```bash
curl -H "Authorization: Bearer YOUR_JWT_TOKEN" \
     http://localhost:8000/api/v1/points/user-levels/
```

---

## 🏗️ 系统架构概览

### 核心模块

```
┌─────────────────────────────────────────────────────────────┐
│                    多租户积分系统                             │
├─────────────────────────────────────────────────────────────┤
│  🎯 积分系统     💎 VIP标签     📄 许可证     📊 统计分析    │
│  ├─ 用户档案     ├─ 标签管理     ├─ 分配管理   ├─ 积分统计    │
│  ├─ 积分操作     ├─ 期限管理     ├─ 激活撤销   ├─ 趋势分析    │
│  ├─ 等级升级     ├─ 权限增强     ├─ 批量操作   └─ 排行榜      │
│  └─ 权限计算     └─ 自动续期     └─ 使用记录                 │
└─────────────────────────────────────────────────────────────┘
```

### 数据流向

```
用户请求 → JWT认证 → 租户隔离 → 权限验证 → 业务逻辑 → 数据返回
    ↓           ↓           ↓           ↓           ↓
  Bearer      解析用户     确定租户     检查权限     执行操作
  Token       信息        范围        等级        更新状态
```

---

## 🎯 主要功能特性

### ✅ 已实现功能

- **🏢 多租户架构**: 完全隔离的租户数据和权限
- **🎯 积分系统**: 获得、消费、过期、等级升级
- **💎 VIP标签**: 期限管理、宽限期、自动续期
- **📄 许可证分配**: 智能分配、批量操作、使用追踪
- **🔐 权限系统**: 多层权限计算、细粒度控制
- **📊 统计分析**: 实时统计、趋势分析、排行榜
- **⚡ 高性能**: 数据库优化、缓存机制、异步处理

### 🎨 设计特点

- **原子模型**: 模型设计遵循单一职责原则
- **服务驱动**: 业务逻辑封装在服务层
- **API优先**: 完整的REST API设计
- **文档完善**: 详细的API文档和使用案例

---

## 📊 使用统计

### API端点统计

| 模块 | 端点数量 | 主要功能 |
|------|----------|----------|
| **积分系统** | 15+ | 用户档案、积分操作、权限查询 |
| **VIP标签** | 10+ | 标签授予、续期、撤销、状态查询 |
| **许可证分配** | 12+ | 分配管理、批量操作、统计分析 |
| **统计分析** | 8+ | 积分统计、趋势分析、排行榜 |
| **总计** | **45+** | 完整的业务功能覆盖 |

### 响应时间指标

- **平均响应时间**: < 200ms
- **99%响应时间**: < 500ms
- **并发支持**: 1000+ 请求/秒
- **可用性**: 99.9%+

---

## 🔗 相关链接

- **API文档**: http://localhost:8000/api/v1/docs/
- **ReDoc文档**: http://localhost:8000/api/v1/redoc/
- **Django Admin**: http://localhost:8000/admin/
- **健康检查**: http://localhost:8000/api/v1/health/

---

## 📞 支持与反馈

如果在使用过程中遇到问题，请参考：

1. **错误处理指南**: [07_错误处理和最佳实践.md](./07_错误处理和最佳实践.md)
2. **常见问题**: 查看各模块文档的FAQ部分
3. **最佳实践**: 参考实际使用案例

---

## 📝 版本信息

- **API版本**: v1.1 (RIPER-5方案A重构版)
- **文档版本**: 1.1.0
- **最后更新**: 2025-09-26
- **兼容性**: Django 5.2+

### 🔄 RIPER-5方案A重构更新 (2024年9月26日)

本API文档已验证与RIPER-5方案A重构标准的兼容性：

- ✅ **许可证字段**: 使用正确的 `max_activations` 字段（许可证实际使用值）
- ✅ **字段语义**: 所有字段命名符合模板配置与实际使用值的区分标准
- ✅ **API响应**: 所有示例使用正确的字段结构

**注意**: 文档中的许可证相关字段已确认与后端系统字段重构保持一致。

---

**🎉 开始探索强大的多租户积分系统API！**
