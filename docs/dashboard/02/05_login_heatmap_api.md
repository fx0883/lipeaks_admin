# 用户登录热力图 API

## 功能描述

此API提供用户登录情况的热力图数据，按星期几和小时统计登录次数，帮助管理员了解用户登录的时间分布模式，识别高峰和低谷时段。适用于生成热力图，直观展示不同时间段的登录活跃度。

## 请求

### 请求URL

```
GET /api/v1/charts/login-heatmap/
```

### 请求参数

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| start_date | string | 否 | **当前日期往前30天** | 开始日期，格式为YYYY-MM-DD |
| end_date | string | 否 | **当前日期** | 结束日期，格式为YYYY-MM-DD |

### 请求示例

```
GET /api/v1/charts/login-heatmap/?start_date=2023-01-01&end_date=2023-01-31
```

## 响应

### 响应参数

| 参数 | 类型 | 说明 |
|------|------|------|
| code | integer | 响应码，2000表示成功 |
| message | string | 响应消息 |
| data | object | 响应数据 |
| data.chart_type | string | 图表类型，固定为"heatmap" |
| data.title | string | 图表标题 |
| data.description | string | 图表描述 |
| data.x_labels | array | X轴标签数组，表示星期几（周一到周日） |
| data.y_labels | array | Y轴标签数组，表示小时（0时到23时） |
| data.dataset | array | 热力图数据点数组，每个数据点是形如[x, y, value]的数组，表示在x轴索引和y轴索引位置的值 |
| data.summary | object | 汇总数据 |
| data.summary.total_logins | integer | 总登录次数 |
| data.summary.peak_hour | string | 登录高峰时段（如"周一 10时"） |
| data.summary.peak_hour_count | integer | 高峰时段的登录次数 |
| data.summary.lowest_hour | string | 登录低谷时段（如"周日 3时"） |
| data.summary.lowest_hour_count | integer | 低谷时段的登录次数 |

### 响应示例

```json
{
  "code": 2000,
  "message": "success",
  "data": {
    "chart_type": "heatmap",
    "title": "用户登录热力图",
    "description": "不同时间段的登录活跃度",
    "x_labels": ["周一", "周二", "周三", "周四", "周五", "周六", "周日"],
    "y_labels": ["0时", "1时", "2时", "3时", "4时", "5时", "6时", "7时", "8时", "9时", "10时", "11时", "12时", "13时", "14时", "15时", "16时", "17时", "18时", "19时", "20时", "21时", "22时", "23时"],
    "dataset": [
      [0, 9, 25],  // 周一9时有25次登录
      [0, 10, 45], // 周一10时有45次登录
      [0, 11, 30],
      [1, 9, 20],
      [1, 10, 35],
      // ...更多数据点
    ],
    "summary": {
      "total_logins": 1250,
      "peak_hour": "周一 10时",
      "peak_hour_count": 45,
      "lowest_hour": "周日 3时",
      "lowest_hour_count": 0
    }
  }
}
```

## 前端展示建议

### 图表类型

推荐使用热力图（Heatmap）：
- X轴：星期几（周一到周日）
- Y轴：小时（0时到23时）
- 颜色深浅：表示登录次数的多少，颜色越深表示登录次数越多

### 交互功能

1. **日期范围选择器**：提供日期选择控件，让用户自定义查询时间范围
2. **悬停提示**：鼠标悬停在热力图单元格上显示详细信息（星期几、小时、登录次数）
3. **颜色图例**：显示颜色与登录次数的对应关系
4. **缩放功能**：可选功能，允许用户放大查看特定时间段的详细数据

### 汇总信息展示

在图表旁边展示汇总信息：
- 总登录次数：1,250次
- 登录高峰时段：周一 10时（45次）
- 登录低谷时段：周日 3时（0次）

## 注意事项

1. 热力图数据集中的坐标是基于0索引的：
   - x: 0-6 分别表示周一到周日
   - y: 0-23 分别表示0时到23时
2. 当没有登录数据时，API会返回空的数据集和相应的提示信息
3. 热力图颜色应根据登录次数的分布范围自动调整，以便更好地展示数据差异
4. 考虑用户所在时区与服务器时区的差异，可能需要在前端进行时区调整
5. 建议在热力图旁边显示颜色图例，帮助用户理解颜色与登录次数的对应关系 