# pure-admin-thin-i18n 开发指南

本文档提供 pure-admin-thin-i18n 项目的开发、构建和部署说明。

## 1. 环境准备

### 1.1 系统要求

- **Node.js**: 版本 ^18.18.0 || ^20.9.0 || >=22.0.0
- **包管理工具**: pnpm 9.0.0 或更高版本
- **浏览器**: 支持现代浏览器，如 Chrome、Firefox、Edge 等

### 1.2 安装依赖工具

1. 安装 Node.js（推荐使用 nvm 管理 Node.js 版本）

```bash
# 使用 nvm 安装指定版本的 Node.js
nvm install 20.9.0
nvm use 20.9.0
```

2. 安装 pnpm

```bash
npm install -g pnpm@9
```

3. 启用 Corepack（可选，针对 Node.js >= 16.13）

```bash
corepack enable
corepack prepare pnpm@latest --activate
```

## 2. 项目设置

### 2.1 克隆项目

```bash
git clone https://github.com/pure-admin/pure-admin-thin.git pure-admin-thin-i18n
cd pure-admin-thin-i18n
git checkout i18n
```

### 2.2 安装依赖

```bash
pnpm install
```

### 2.3 配置环境变量

1. 开发环境: 根据需要修改 `.env.development` 文件
2. 生产环境: 根据需要修改 `.env.production` 文件

主要环境变量说明:

- `VITE_API_BASE_URL`: API 接口的基础 URL
- `VITE_PUBLIC_PATH`: 项目部署的基础路径
- `VITE_ROUTER_HISTORY`: 路由模式 (hash 或 html5)
- `VITE_HIDE_HOME`: 是否隐藏首页

## 3. 开发与调试

### 3.1 启动开发服务器

```bash
pnpm dev
# 或
pnpm serve
```

执行上述命令后，开发服务器将会启动，默认地址为 `http://localhost:5173`。

### 3.2 代码规范检查

```bash
# ESLint 检查
pnpm lint:eslint

# Prettier 格式化
pnpm lint:prettier

# Stylelint 检查
pnpm lint:stylelint

# 执行所有检查
pnpm lint
```

### 3.3 类型检查

```bash
pnpm typecheck
```

## 4. 项目结构说明

开发过程中需要了解的主要目录和文件：

```
src/
├── api/              # API请求接口
├── components/       # 通用组件
├── layout/           # 布局组件
├── router/           # 路由配置
│   └── modules/      # 路由模块
├── store/            # Pinia状态管理
│   └── modules/      # 状态模块
├── styles/           # 全局样式
├── utils/            # 工具函数
└── views/            # 页面视图组件
```

## 5. 功能开发

### 5.1 添加新页面

1. 在 `src/views/` 目录下创建新的页面组件
2. 在 `src/router/modules/` 目录下添加路由配置
3. 添加国际化支持（如需）

示例路由配置:

```typescript
// src/router/modules/example.ts
export default {
  path: "/example",
  name: "Example",
  component: () => import("@/layout/index.vue"),
  meta: {
    title: "exampleSystem",  // i18n key
    icon: "menu",
    rank: 7
  },
  children: [
    {
      path: "/example/page",
      name: "ExamplePage",
      component: () => import("@/views/example/index.vue"),
      meta: {
        title: "examplePage"  // i18n key
      }
    }
  ]
};
```

### 5.2 添加 API 接口

1. 在 `src/api/` 目录下创建或修改 API 文件
2. 在 `src/types/api.ts` 中添加类型定义（如需）

示例:

```typescript
// src/api/example.ts
import { http } from "@/utils/http";
import { ApiResponse } from "@/types/api";

export interface ExampleData {
  id: number;
  name: string;
}

export type ExampleResult = ApiResponse<ExampleData[]>;

export const getExampleList = (params?: object) => {
  return http.request<ExampleResult>("get", "/example/list", { params });
};
```

### 5.3 添加国际化内容

1. 在 `locales/zh-CN.yaml` 和 `locales/en.yaml` 文件中添加翻译内容

示例:

```yaml
# locales/zh-CN.yaml
exampleSystem: 示例系统
examplePage: 示例页面

# locales/en.yaml
exampleSystem: Example System
examplePage: Example Page
```

### 5.4 添加权限控制

1. 在路由配置中添加角色限制

```typescript
// 在路由元信息中添加roles
meta: {
  title: "examplePage",
  roles: ["admin", "editor"]  // 只有admin和editor角色可访问
}
```

2. 使用权限组件控制页面元素

```html
<Auth :value="['admin']">
  <el-button>仅管理员可见按钮</el-button>
</Auth>

<Perms :value="['example:edit']">
  <el-button>拥有编辑权限时可见</el-button>
</Perms>
```

## 6. 构建与发布

### 6.1 构建生产版本

```bash
# 构建生产环境
pnpm build

# 构建测试环境
pnpm build:staging
```

构建完成后，生产文件将输出到 `dist` 目录。

### 6.2 预览构建结果

```bash
pnpm preview

# 或构建并预览
pnpm preview:build
```

### 6.3 分析构建体积

```bash
pnpm report
```

执行后将生成可视化的构建分析报告。

### 6.4 Docker 部署

1. 构建 Docker 镜像

```bash
docker build -t pure-admin-thin:latest .
```

2. 运行 Docker 容器

```bash
docker run -d -p 8080:80 pure-admin-thin:latest
```

通过 `http://localhost:8080` 访问应用。

## 7. 扩展与定制

### 7.1 添加新的依赖

```bash
pnpm add <package-name>

# 添加开发依赖
pnpm add -D <package-name>
```

### 7.2 修改主题

1. 覆盖 Element Plus 主题变量

```scss
// src/style/element-plus.scss
@forward "element-plus/theme-chalk/src/common/var.scss" with (
  $colors: (
    "primary": (
      "base": #1890ff,
    ),
    // 其他颜色变量...
  ),
);
```

2. 配置 Tailwind 主题

```js
// tailwind.config.js
module.exports = {
  theme: {
    extend: {
      colors: {
        primary: "#1890ff",
        // 其他颜色...
      },
    },
  },
};
```

### 7.3 添加新的图标

1. 使用 Iconify 图标

```html
<IconifyIconOnline icon="ep:home" />
```

2. 添加自定义字体图标

将字体文件添加到 `src/assets/iconfont/` 目录，然后在组件中使用:

```html
<FontIcon icon="icon-custom" />
```

## 8. 常见问题

### 8.1 依赖安装问题

如果安装依赖时出现问题，可尝试:

```bash
# 清除缓存并重新安装
pnpm clean:cache

# 或者更新 pnpm
npm install -g pnpm@latest
```

### 8.2 开发服务器启动失败

1. 检查端口是否被占用
2. 检查 Node.js 版本是否符合要求
3. 检查环境变量配置是否正确

### 8.3 构建错误

1. 检查 TypeScript 类型错误
2. 清除 `node_modules` 后重新安装依赖
3. 查看构建日志中的具体错误信息

### 8.4 部署问题

1. **404 错误**: 检查 `VITE_PUBLIC_PATH` 配置和服务器基础路径是否一致
2. **API 请求失败**: 检查 `VITE_API_BASE_URL` 配置和跨域设置
3. **资源加载失败**: 检查静态资源路径是否正确

## 9. 最佳实践

### 9.1 组件设计原则

- 遵循单一职责原则
- 组件名称使用 PascalCase 格式
- 使用 Props 类型验证
- 避免过深的组件嵌套

### 9.2 性能优化

- 使用 `v-memo` 缓存不经常变化的内容
- 合理使用 `computed` 和 `watch`
- 大型列表使用虚拟滚动
- 路由组件使用异步加载

### 9.3 代码提交规范

提交信息应遵循以下格式:

```
<type>(<scope>): <subject>

<body>

<footer>
```

常用的 type 有:
- feat: 新功能
- fix: 修复bug
- docs: 文档更新
- style: 代码风格更改
- refactor: 代码重构
- perf: 性能优化
- test: 测试相关
- chore: 构建过程或辅助工具变动

### 9.4 协作流程

1. 从主分支创建功能分支
2. 在功能分支上开发
3. 提交前运行代码规范检查和类型检查
4. 提交代码并创建合并请求
5. 代码评审后合并到主分支

## 10. 参考资源

- [Vue 3 文档](https://v3.vuejs.org/)
- [Element Plus 文档](https://element-plus.org/)
- [Vite 文档](https://vitejs.dev/)
- [Pinia 文档](https://pinia.vuejs.org/)
- [vue-pure-admin 文档](https://pure-admin.cn/)
- [Tailwind CSS 文档](https://tailwindcss.com/)
- [TypeScript 文档](https://www.typescriptlang.org/) 