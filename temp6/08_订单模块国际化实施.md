# 订单模块国际化实施

## 1. 概述

订单模块国际化实施文档定义了如何使订单管理模块支持多语言和多地区，确保系统能够适应不同语言环境和地区习惯的用户需求。本文档基于项目现有的国际化框架（Vue I18n + YAML），提供订单管理模块所需的国际化策略、翻译资源和实施方法。

## 2. 国际化需求

订单管理模块的国际化需要满足以下需求：

1. **多语言支持**：支持中文、英文等多种语言
2. **日期格式本地化**：根据地区显示不同格式的日期时间
3. **货币格式本地化**：根据地区显示不同的货币符号和格式
4. **数字格式本地化**：根据地区显示不同的数字格式（如千位分隔符）
5. **动态内容翻译**：支持从后端获取的动态内容的翻译
6. **状态文本国际化**：订单状态等枚举值的国际化
7. **错误信息国际化**：表单验证等错误提示信息的国际化
8. **右到左（RTL）语言支持**：支持阿拉伯语等从右到左书写的语言

## 3. 国际化框架

订单管理模块将沿用项目现有的国际化框架：

- **Vue I18n**：Vue官方的国际化插件
- **YAML格式**：使用YAML文件存储翻译资源
- **语言切换**：支持在运行时切换语言
- **命名空间**：使用命名空间隔离不同模块的翻译资源

## 4. 翻译资源结构

订单模块的翻译资源将组织为以下结构：

### 4.1 文件组织

```
locales/
├── zh-CN.yaml      # 中文简体翻译
├── en.yaml         # 英文翻译
└── ...             # 其他语言翻译
```

### 4.2 命名空间结构

```yaml
# 订单模块命名空间
order:
  # 通用
  common:
    title: 订单管理
    create: 创建订单
    edit: 编辑订单
    detail: 订单详情
    list: 订单列表
    
  # 字段标签
  fields:
    orderNumber: 订单编号
    customer: 客户
    contactPerson: 联系人
    serviceType: 服务类型
    language: 语种
    # ... 其他字段
    
  # 状态
  status:
    paymentStatus:
      paid: 已支付
      unpaid: 未支付
    invoiceStatus:
      issued: 已开具
      pending: 待开具
      notRequired: 无需开具
    # ... 其他状态
    
  # 操作按钮
  actions:
    save: 保存
    submit: 提交
    cancel: 取消
    delete: 删除
    export: 导出
    import: 导入
    # ... 其他操作
    
  # 提示消息
  messages:
    createSuccess: 订单创建成功
    updateSuccess: 订单更新成功
    deleteConfirm: 确定删除此订单吗？
    # ... 其他消息
    
  # 错误提示
  errors:
    required: 此字段为必填项
    invalidFormat: 格式无效
    # ... 其他错误提示
    
  # 统计分析
  statistics:
    title: 订单统计分析
    totalOrders: 订单总数
    totalAmount: 订单总金额
    # ... 其他统计项
    
  # 历史管理
  history:
    title: 订单历史记录
    version: 版本
    compare: 比较
    restore: 还原
    # ... 其他历史相关翻译
```

## 5. 语言资源示例

### 5.1 中文（zh-CN.yaml）

```yaml
order:
  common:
    title: 订单管理
    create: 创建订单
    edit: 编辑订单
    detail: 订单详情
    list: 订单列表
    statistics: 订单统计分析
    history: 订单历史记录
    
  fields:
    orderNumber: 订单编号
    customer: 客户
    contactPerson: 联系人
    servicePlatform: 来源平台
    projectManager: 项目负责人
    customerType: 客户类型
    orderDate: 下单日期
    serviceType: 服务类型
    language: 语种
    customerCount: 客户数量
    translationCount: 翻译数量
    serviceTime: 服务时间
    projectLocation: 项目地点
    translator: 译员
    customerPrice: 客户单价
    customerTotalAmount: 客户总价
    translatorFee: 译员费用
    translatorPrice: 译员单价
    translatorPaymentStatus: 译员支付状态
    translatorPaymentMethod: 译员支付方式
    projectFee: 项目费用
    projectDetails: 项目明细
    costDetails: 费用明细
    refundAmount: 退款金额
    refundReason: 退款原因
    paymentStatus: 支付状态
    paymentDate: 支付日期
    paymentMethod: 支付方式
    paymentRemarks: 支付备注
    invoiceStatus: 发票状态
    invoiceInfo: 发票信息
    contractNumber: 合同编号
    contractInfo: 合同信息
    contractRemarks: 合同备注
    deliveryAddress: 收件地址
    orderAddress: 订单地址
    remarks: 备注
    followUpRecord: 回访记录
    profit: 毛利
    profitRate: 毛利率
    
  status:
    paymentStatus:
      paid: 已支付
      unpaid: 未支付
    invoiceStatus:
      issued: 已开具
      pending: 待开具
      notRequired: 无需开具
    customerType:
      new: 新客户
      old: 老客户
    urgency:
      urgent: 紧急
      normal: 普通
      
  actions:
    save: 保存
    submit: 提交
    cancel: 取消
    delete: 删除
    export: 导出
    import: 导入
    search: 查询
    reset: 重置
    add: 添加
    edit: 编辑
    view: 查看
    print: 打印
    download: 下载
    upload: 上传
    confirm: 确认
    back: 返回
    next: 下一步
    previous: 上一步
    saveDraft: 保存草稿
    
  messages:
    createSuccess: 订单创建成功
    updateSuccess: 订单更新成功
    deleteSuccess: 订单删除成功
    importSuccess: 导入成功，共导入 {count} 条数据
    exportSuccess: 导出成功
    restoreSuccess: 订单已还原到版本 {version}
    deleteConfirm: 确定删除此订单吗？
    batchDeleteConfirm: 确定删除选中的 {count} 个订单吗？
    unsavedChanges: 有未保存的更改，确定离开吗？
    
  errors:
    required: {field} 为必填项
    invalidFormat: {field} 格式无效
    minValue: {field} 不能小于 {min}
    maxValue: {field} 不能大于 {max}
    minLength: {field} 长度不能小于 {min} 个字符
    maxLength: {field} 长度不能大于 {max} 个字符
    invalidDate: 日期格式无效
    invalidAmount: 金额格式无效
    serverError: 服务器错误，请稍后重试
    networkError: 网络连接错误，请检查网络连接
    
  statistics:
    title: 订单统计分析
    totalOrders: 订单总数
    totalAmount: 订单总金额
    totalProfit: 总毛利
    averageOrderAmount: 平均订单金额
    averageProfitRate: 平均毛利率
    unpaidAmount: 未支付金额
    byPaymentStatus: 按支付状态分布
    byServiceType: 按服务类型分布
    byPeriod: 按时间段分布
    daily: 按日
    weekly: 按周
    monthly: 按月
    yearly: 按年
    
  history:
    title: 订单历史记录
    version: 版本
    currentVersion: 当前版本
    modifiedBy: 修改人
    modifiedAt: 修改时间
    changeDetails: 变更详情
    field: 字段
    oldValue: 旧值
    newValue: 新值
    compare: 比较
    restore: 还原
    restoreConfirm: 确定将订单还原到版本 {version} 吗？
    createAction: 创建订单
    updateAction: 更新订单
    restoreAction: 还原到版本 {version}
```

### 5.2 英文（en.yaml）

```yaml
order:
  common:
    title: Order Management
    create: Create Order
    edit: Edit Order
    detail: Order Detail
    list: Order List
    statistics: Order Statistics
    history: Order History
    
  fields:
    orderNumber: Order Number
    customer: Customer
    contactPerson: Contact Person
    servicePlatform: Source Platform
    projectManager: Project Manager
    customerType: Customer Type
    orderDate: Order Date
    serviceType: Service Type
    language: Language
    customerCount: Customer Count
    translationCount: Translation Count
    serviceTime: Service Time
    projectLocation: Project Location
    translator: Translator
    customerPrice: Customer Price
    customerTotalAmount: Customer Total Amount
    translatorFee: Translator Fee
    translatorPrice: Translator Price
    translatorPaymentStatus: Translator Payment Status
    translatorPaymentMethod: Translator Payment Method
    projectFee: Project Fee
    projectDetails: Project Details
    costDetails: Cost Details
    refundAmount: Refund Amount
    refundReason: Refund Reason
    paymentStatus: Payment Status
    paymentDate: Payment Date
    paymentMethod: Payment Method
    paymentRemarks: Payment Remarks
    invoiceStatus: Invoice Status
    invoiceInfo: Invoice Information
    contractNumber: Contract Number
    contractInfo: Contract Information
    contractRemarks: Contract Remarks
    deliveryAddress: Delivery Address
    orderAddress: Order Address
    remarks: Remarks
    followUpRecord: Follow-up Record
    profit: Profit
    profitRate: Profit Rate
    
  status:
    paymentStatus:
      paid: Paid
      unpaid: Unpaid
    invoiceStatus:
      issued: Issued
      pending: Pending
      notRequired: Not Required
    customerType:
      new: New Customer
      old: Existing Customer
    urgency:
      urgent: Urgent
      normal: Normal
      
  actions:
    save: Save
    submit: Submit
    cancel: Cancel
    delete: Delete
    export: Export
    import: Import
    search: Search
    reset: Reset
    add: Add
    edit: Edit
    view: View
    print: Print
    download: Download
    upload: Upload
    confirm: Confirm
    back: Back
    next: Next
    previous: Previous
    saveDraft: Save Draft
    
  messages:
    createSuccess: Order created successfully
    updateSuccess: Order updated successfully
    deleteSuccess: Order deleted successfully
    importSuccess: Import successful, {count} records imported
    exportSuccess: Export successful
    restoreSuccess: Order restored to version {version}
    deleteConfirm: Are you sure you want to delete this order?
    batchDeleteConfirm: Are you sure you want to delete {count} selected orders?
    unsavedChanges: You have unsaved changes, are you sure you want to leave?
    
  errors:
    required: {field} is required
    invalidFormat: Invalid format for {field}
    minValue: {field} cannot be less than {min}
    maxValue: {field} cannot be greater than {max}
    minLength: {field} must be at least {min} characters
    maxLength: {field} cannot exceed {max} characters
    invalidDate: Invalid date format
    invalidAmount: Invalid amount format
    serverError: Server error, please try again later
    networkError: Network connection error, please check your connection
    
  statistics:
    title: Order Statistics
    totalOrders: Total Orders
    totalAmount: Total Amount
    totalProfit: Total Profit
    averageOrderAmount: Average Order Amount
    averageProfitRate: Average Profit Rate
    unpaidAmount: Unpaid Amount
    byPaymentStatus: By Payment Status
    byServiceType: By Service Type
    byPeriod: By Period
    daily: Daily
    weekly: Weekly
    monthly: Monthly
    yearly: Yearly
    
  history:
    title: Order History
    version: Version
    currentVersion: Current Version
    modifiedBy: Modified By
    modifiedAt: Modified At
    changeDetails: Change Details
    field: Field
    oldValue: Old Value
    newValue: New Value
    compare: Compare
    restore: Restore
    restoreConfirm: Are you sure you want to restore the order to version {version}?
    createAction: Create Order
    updateAction: Update Order
    restoreAction: Restore to version {version}
```

## 6. 国际化使用方法

### 6.1 组件中使用翻译

在Vue组件中使用翻译资源的方法：

```vue
<template>
  <div>
    <h1>{{ $t('order.common.title') }}</h1>
    <el-button type="primary">{{ $t('order.actions.create') }}</el-button>
    
    <el-table :data="orderList">
      <el-table-column prop="orderNumber" :label="$t('order.fields.orderNumber')" />
      <el-table-column prop="customer" :label="$t('order.fields.customer')" />
      <!-- 其他列 -->
    </el-table>
  </div>
</template>

<script setup lang="ts">
import { useI18n } from 'vue-i18n';

// 获取i18n实例
const { t } = useI18n();

// 在JavaScript/TypeScript中使用翻译
const title = t('order.common.title');
</script>
```

### 6.2 动态内容翻译

对于从后端获取的枚举值等动态内容，需要进行映射翻译：

```vue
<template>
  <el-tag :type="getPaymentStatusType(order.paymentStatus)">
    {{ getPaymentStatusText(order.paymentStatus) }}
  </el-tag>
</template>

<script setup lang="ts">
import { useI18n } from 'vue-i18n';

const { t } = useI18n();

// 获取支付状态显示文本
const getPaymentStatusText = (status: string) => {
  return t(`order.status.paymentStatus.${status}`);
};

// 获取支付状态对应的标签类型
const getPaymentStatusType = (status: string) => {
  const types = {
    'paid': 'success',
    'unpaid': 'warning'
  };
  return types[status] || 'info';
};
</script>
```

### 6.3 带参数的翻译

对于包含变量的文本，可以使用参数化翻译：

```vue
<script setup lang="ts">
import { useI18n } from 'vue-i18n';

const { t } = useI18n();

// 带参数的翻译
const showImportSuccess = (count: number) => {
  const message = t('order.messages.importSuccess', { count });
  // 显示消息提示
};

// 验证错误消息
const getRequiredError = (field: string) => {
  return t('order.errors.required', { field: t(`order.fields.${field}`) });
};
</script>
```

### 6.4 日期格式化

使用i18n处理不同地区的日期格式：

```vue
<template>
  <div>{{ $d(orderDate, 'short') }}</div>
  <div>{{ $d(orderDate, 'long') }}</div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

// 日期对象
const orderDate = ref(new Date());
</script>
```

### 6.5 货币格式化

处理不同地区的货币格式：

```vue
<template>
  <div>{{ $n(amount, 'currency') }}</div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

// 金额
const amount = ref(1500.50);
</script>
```

## 7. 国际化扩展

### 7.1 数字格式化助手

为便于格式化金额和百分比，可以创建格式化助手：

```typescript
// utils/formatters.ts
import { useI18n } from 'vue-i18n';

export function useFormatters() {
  const { n } = useI18n();
  
  // 格式化货币
  const formatCurrency = (value: number) => {
    return n(value, 'currency');
  };
  
  // 格式化百分比
  const formatPercent = (value: number) => {
    return n(value, 'percent');
  };
  
  // 格式化数量
  const formatNumber = (value: number) => {
    return n(value, 'decimal');
  };
  
  return {
    formatCurrency,
    formatPercent,
    formatNumber
  };
}
```

### 7.2 日期格式化助手

为统一处理日期格式，可以创建日期格式化助手：

```typescript
// utils/dateFormatters.ts
import { useI18n } from 'vue-i18n';
import dayjs from 'dayjs';

export function useDateFormatters() {
  const { d } = useI18n();
  
  // 格式化日期（短格式）
  const formatShortDate = (date: Date | string) => {
    if (!date) return '';
    return d(dayjs(date).toDate(), 'short');
  };
  
  // 格式化日期（长格式）
  const formatLongDate = (date: Date | string) => {
    if (!date) return '';
    return d(dayjs(date).toDate(), 'long');
  };
  
  // 格式化日期时间
  const formatDateTime = (date: Date | string) => {
    if (!date) return '';
    return d(dayjs(date).toDate(), 'long', { includeTime: true });
  };
  
  return {
    formatShortDate,
    formatLongDate,
    formatDateTime
  };
}
```

### 7.3 验证错误消息国际化

对于表单验证，可以创建国际化的验证规则：

```typescript
// utils/validationRules.ts
import { useI18n } from 'vue-i18n';

export function useValidationRules() {
  const { t } = useI18n();
  
  // 必填规则
  const required = (field: string) => ({
    required: true,
    message: t('order.errors.required', { field: t(`order.fields.${field}`) }),
    trigger: 'blur'
  });
  
  // 最小值规则
  const minValue = (field: string, min: number) => ({
    type: 'number',
    min,
    message: t('order.errors.minValue', { field: t(`order.fields.${field}`), min }),
    trigger: 'blur'
  });
  
  // 最大值规则
  const maxValue = (field: string, max: number) => ({
    type: 'number',
    max,
    message: t('order.errors.maxValue', { field: t(`order.fields.${field}`), max }),
    trigger: 'blur'
  });
  
  return {
    required,
    minValue,
    maxValue
  };
}
```

## 8. RTL支持

为支持阿拉伯语等从右到左书写的语言，需要进行以下配置：

### 8.1 HTML方向属性设置

```vue
<template>
  <div :dir="direction">
    <!-- 应用内容 -->
  </div>
</template>

<script setup lang="ts">
import { computed } from 'vue';
import { useI18n } from 'vue-i18n';

const { locale } = useI18n();

// 根据当前语言设置文本方向
const direction = computed(() => {
  // RTL语言列表
  const rtlLanguages = ['ar', 'he', 'fa'];
  return rtlLanguages.includes(locale.value) ? 'rtl' : 'ltr';
});
</script>
```

### 8.2 CSS调整

为RTL布局创建特定的CSS：

```scss
/* styles/rtl.scss */
[dir="rtl"] {
  // 反转填充和边距
  .el-form-item__label {
    text-align: right;
  }
  
  // 反转图标方向
  .el-icon-arrow-right {
    transform: rotate(180deg);
  }
  
  // 反转表格排序图标
  .el-table .sort-caret.ascending {
    transform: rotate(180deg);
  }
  
  // 其他RTL特定样式
}
```

## 9. 国际化测试

为确保国际化的正确性，需要进行以下测试：

### 9.1 文本完整性测试

- 检查所有UI元素是否都有相应的翻译
- 检查长文本在翻译后是否仍能适应UI布局

### 9.2 格式化测试

- 测试不同语言环境下的日期格式
- 测试不同语言环境下的货币格式
- 测试不同语言环境下的数字格式

### 9.3 RTL布局测试

- 测试RTL语言下的页面布局是否正确
- 测试图标、按钮等元素的方向是否正确

### 9.4 动态内容测试

- 测试从后端获取的动态内容是否正确翻译
- 测试带参数的消息是否正确显示

## 10. 国际化实施步骤

### 10.1 准备阶段

1. 确定支持的语言列表
2. 收集所有需要翻译的文本
3. 创建翻译文件骨架

### 10.2 实施阶段

1. 在YAML文件中添加订单模块的翻译资源
2. 更新组件，使用翻译资源替代硬编码文本
3. 实现格式化助手和验证规则

### 10.3 测试阶段

1. 在不同语言环境下测试UI
2. 检查并修复翻译问题
3. 确保所有功能在不同语言环境下正常工作

### 10.4 优化阶段

1. 按需加载翻译资源，提高性能
2. 实现翻译缓存机制
3. 创建翻译管理工具，便于维护 